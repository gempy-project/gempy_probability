<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.1 - Only Pyro &#8212; GemPy 2023.2.0b1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=270d38c7" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=e5fbc548" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=39c4bfd0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.2 - Including GemPy" href="2-thickness_problem_gempy.html" />
    <link rel="prev" title="Ôªø2 - Probabilistic Geomodel" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-basic-geology-1-thickness-problem-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="only-pyro">
<span id="sphx-glr-examples-basic-geology-1-thickness-problem-py"></span><h1>2.1 - Only Pyro<a class="headerlink" href="#only-pyro" title="Permalink to this heading">¬∂</a></h1>
<section id="model-definition">
<h2>Model definition<a class="headerlink" href="#model-definition" title="Permalink to this heading">¬∂</a></h2>
<p>Same problem as before, let‚Äôs assume the observations are layer
thickness measurements taken on an outcrop. Now, in the previous example
we chose a prior for the mean arbitrarily:
<span class="math notranslate nohighlight">\(ùúá‚àºNormal(mu=10.0, sigma=5.0)\)</span>‚Äìsomething that made sense for these
specific data set. If we do not have any further information, keeping
an uninformative prior and let the data to dictate the final value of
the inference is the sensible way forward. However, this also enable to
add information to the system by setting informative priors.</p>
<p>Imagine we get a borehole with the tops of the two interfaces of
interest. Each of this data point will be a random variable itself since
the accuracy of the exact 3D location will be always limited. Notice
that this two data points refer to depth not to thickness‚Äìthe unit of
the rest of the observations. Therefore, the first step would be to
perform a transformation of the parameters into the observations space.
Naturally in this example a simple subtraction will suffice.</p>
<p>Now we can define the probabilistic models:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = -2</span>
</pre></div>
</div>
</section>
<section id="importing-necessary-libraries">
<h2>Importing Necessary Libraries<a class="headerlink" href="#importing-necessary-libraries" title="Permalink to this heading">¬∂</a></h2>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pyro</span>
<span class="kn">import</span> <span class="nn">pyro.distributions</span> <span class="k">as</span> <span class="nn">dist</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">pyro.infer</span> <span class="kn">import</span> <span class="n">MCMC</span><span class="p">,</span> <span class="n">NUTS</span><span class="p">,</span> <span class="n">Predictive</span>
<span class="kn">from</span> <span class="nn">pyro.infer.inspect</span> <span class="kn">import</span> <span class="n">get_dependencies</span>
<span class="kn">from</span> <span class="nn">gempy_probability.plot_posterior</span> <span class="kn">import</span> <span class="n">PlotPosterior</span><span class="p">,</span> <span class="n">default_red</span><span class="p">,</span> <span class="n">default_blue</span>
<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
</pre></div>
</div>
</section>
<section id="introduction-to-the-problem">
<h2>Introduction to the Problem<a class="headerlink" href="#introduction-to-the-problem" title="Permalink to this heading">¬∂</a></h2>
<p>In this example, we are considering layer thickness measurements taken on an outcrop as our observations.
We use a probabilistic approach to model these observations, allowing for the inclusion of prior knowledge
and uncertainty quantification.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting the working directory for sphinx gallery</span>
<span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="k">if</span> <span class="s1">&#39;examples&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cwd</span><span class="p">:</span>
    <span class="n">path_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;/examples/tutorials/ch5_probabilistic_modeling&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">path_dir</span> <span class="o">=</span> <span class="n">cwd</span>
</pre></div>
</div>
</section>
<section id="defining-the-observations-and-model">
<h2>Defining the Observations and Model<a class="headerlink" href="#defining-the-observations-and-model" title="Permalink to this heading">¬∂</a></h2>
<p>The observations are layer thickness measurements. We define a Pyro probabilistic model
that uses Normal and Gamma distributions to model the top and bottom interfaces of the layers
and their respective uncertainties.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining observed data</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.12</span><span class="p">])</span>
<span class="n">y_obs_list</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.12</span><span class="p">,</span> <span class="mf">2.06</span><span class="p">,</span> <span class="mf">2.08</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="mf">2.08</span><span class="p">,</span> <span class="mf">2.09</span><span class="p">,</span> <span class="mf">2.19</span><span class="p">,</span> <span class="mf">2.07</span><span class="p">,</span> <span class="mf">2.16</span><span class="p">,</span> <span class="mf">2.11</span><span class="p">,</span> <span class="mf">2.13</span><span class="p">,</span> <span class="mf">1.92</span><span class="p">])</span>
<span class="n">pyro</span><span class="o">.</span><span class="n">set_rng_seed</span><span class="p">(</span><span class="mi">4003</span><span class="p">)</span>

<span class="c1"># Defining the probabilistic model</span>
<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">y_obs_list_</span><span class="p">):</span>
    <span class="n">mu_top</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mu_</span><span class="si">{top}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">3.05</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
    <span class="n">sigma_top</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma_</span><span class="si">{top}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Gamma</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">))</span>
    <span class="n">y_top</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;y_</span><span class="si">{top}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu_top</span><span class="p">,</span> <span class="n">sigma_top</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">3.02</span><span class="p">]))</span>

    <span class="n">mu_bottom</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mu_</span><span class="si">{bottom}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
    <span class="n">sigma_bottom</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\sigma_</span><span class="si">{bottom}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Gamma</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">))</span>
    <span class="n">y_bottom</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;y_</span><span class="si">{bottom}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu_bottom</span><span class="p">,</span> <span class="n">sigma_bottom</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.02</span><span class="p">]))</span>

    <span class="n">mu_thickness</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">deterministic</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mu_</span><span class="si">{thickness}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">mu_top</span> <span class="o">-</span> <span class="n">mu_bottom</span><span class="p">)</span>
    <span class="n">sigma_thickness</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\sigma_</span><span class="si">{thickness}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Gamma</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">))</span>
    <span class="n">y_thickness</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;y_</span><span class="si">{thickness}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu_thickness</span><span class="p">,</span> <span class="n">sigma_thickness</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">y_obs_list_</span><span class="p">)</span>

<span class="c1"># Exploring model dependencies</span>
<span class="n">dependencies</span> <span class="o">=</span> <span class="n">get_dependencies</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_args</span><span class="o">=</span><span class="n">y_obs_list</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="prior-sampling">
<h2>Prior Sampling<a class="headerlink" href="#prior-sampling" title="Permalink to this heading">¬∂</a></h2>
<p>Prior sampling is performed to understand the initial distribution of the model parameters
before considering the observed data.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prior sampling</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">)(</span><span class="n">y_obs_list</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="running-mcmc-sampling">
<h2>Running MCMC Sampling<a class="headerlink" href="#running-mcmc-sampling" title="Permalink to this heading">¬∂</a></h2>
<p>Markov Chain Monte Carlo (MCMC) sampling is used to sample from the posterior distribution,
providing insights into the distribution of model parameters after considering the observed data.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Running MCMC using the NUTS algorithm</span>
<span class="n">nuts_kernel</span> <span class="o">=</span> <span class="n">NUTS</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">mcmc</span> <span class="o">=</span> <span class="n">MCMC</span><span class="p">(</span><span class="n">nuts_kernel</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">warmup_steps</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">y_obs_list</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Warmup:   0%|          | 0/120 [00:00, ?it/s]
Warmup:   7%|6         | 8/120 [00:00, 77.84it/s, step size=2.73e-02, acc. prob=0.703]
Warmup:  13%|#3        | 16/120 [00:00, 22.78it/s, step size=1.16e-02, acc. prob=0.733]
Sample:  21%|##        | 25/120 [00:00, 34.89it/s, step size=1.53e-01, acc. prob=0.260]
Sample:  32%|###1      | 38/120 [00:00, 54.61it/s, step size=1.53e-01, acc. prob=0.223]
Sample:  41%|####      | 49/120 [00:00, 66.53it/s, step size=1.53e-01, acc. prob=0.297]
Sample:  49%|####9     | 59/120 [00:01, 71.07it/s, step size=1.53e-01, acc. prob=0.356]
Sample:  57%|#####6    | 68/120 [00:01, 71.04it/s, step size=1.53e-01, acc. prob=0.384]
Sample:  64%|######4   | 77/120 [00:01, 71.55it/s, step size=1.53e-01, acc. prob=0.414]
Sample:  72%|#######2  | 87/120 [00:01, 76.66it/s, step size=1.53e-01, acc. prob=0.443]
Sample:  80%|########  | 96/120 [00:01, 77.70it/s, step size=1.53e-01, acc. prob=0.474]
Sample:  89%|########9 | 107/120 [00:01, 85.59it/s, step size=1.53e-01, acc. prob=0.489]
Sample:  97%|#########6| 116/120 [00:01, 81.82it/s, step size=1.53e-01, acc. prob=0.513]
Sample: 100%|##########| 120/120 [00:01, 66.31it/s, step size=1.53e-01, acc. prob=0.529]
</pre></div>
</div>
</section>
<section id="posterior-predictive-sampling">
<h2>Posterior Predictive Sampling<a class="headerlink" href="#posterior-predictive-sampling" title="Permalink to this heading">¬∂</a></h2>
<p>After obtaining the posterior samples, we perform posterior predictive sampling.
This step allows us to make predictions based on the posterior distribution.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sampling from the posterior predictive distribution</span>
<span class="n">posterior_samples</span> <span class="o">=</span> <span class="n">mcmc</span><span class="o">.</span><span class="n">get_samples</span><span class="p">()</span>
<span class="n">posterior_predictive</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">posterior_samples</span><span class="p">)(</span><span class="n">y_obs_list</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="visualizing-the-results">
<h2>Visualizing the Results<a class="headerlink" href="#visualizing-the-results" title="Permalink to this heading">¬∂</a></h2>
<p>We use ArviZ, a library for exploratory analysis of Bayesian models, to visualize
the results of our probabilistic model.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating a data object for ArviZ</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_pyro</span><span class="p">(</span>
    <span class="n">posterior</span><span class="o">=</span><span class="n">mcmc</span><span class="p">,</span>
    <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span>
    <span class="n">posterior_predictive</span><span class="o">=</span><span class="n">posterior_predictive</span>
<span class="p">)</span>

<span class="c1"># Plotting trace of the sampled parameters</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_1-thickness_problem_001.png" srcset="../_images/sphx_glr_1-thickness_problem_001.png" alt="$\mu_{bottom}$, $\mu_{bottom}$, $\mu_{top}$, $\mu_{top}$, $\sigma_{bottom}$, $\sigma_{bottom}$, $\sigma_{thickness}$, $\sigma_{thickness}$, $\sigma_{top}$, $\sigma_{top}$" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/leguark/.virtualenvs/gempy-geotop-pilot/lib/python3.10/site-packages/pkg_resources/__init__.py:123: PkgResourcesDeprecationWarning: gempy.-version- is an invalid version and will not be supported in a future release
  warnings.warn(
/home/leguark/.virtualenvs/gempy-geotop-pilot/lib/python3.10/site-packages/arviz/data/io_pyro.py:157: UserWarning: Could not get vectorized trace, log_likelihood group will be omitted. Check your model vectorization or set log_likelihood=False
  warnings.warn(
</pre></div>
</div>
</section>
<section id="density-plots-of-posterior-and-prior">
<h2>Density Plots of Posterior and Prior<a class="headerlink" href="#density-plots-of-posterior-and-prior" title="Permalink to this heading">¬∂</a></h2>
<p>Density plots provide a visual representation of the distribution of the sampled parameters.
Comparing the posterior and prior distributions allows us to assess the impact of the observed data.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting density of posterior and prior distributions</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_density</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">prior</span><span class="p">],</span>
    <span class="n">shade</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span>
    <span class="n">data_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Posterior&quot;</span><span class="p">,</span> <span class="s2">&quot;Prior&quot;</span><span class="p">],</span>
    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">default_red</span><span class="p">,</span> <span class="n">default_blue</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_1-thickness_problem_002.png" srcset="../_images/sphx_glr_1-thickness_problem_002.png" alt="$\mu_{bottom}$, $\mu_{top}$, $\sigma_{bottom}$, $\sigma_{thickness}$, $\sigma_{top}$" class = "sphx-glr-single-img"/></section>
<section id="density-plots-of-posterior-predictive-and-prior-predictive">
<h2>Density Plots of Posterior Predictive and Prior Predictive<a class="headerlink" href="#density-plots-of-posterior-predictive-and-prior-predictive" title="Permalink to this heading">¬∂</a></h2>
<p>These plots show the distribution of the posterior predictive and prior predictive checks.
They help in evaluating the performance and validity of the probabilistic model.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting density of posterior predictive and prior predictive</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_density</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">posterior_predictive</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">prior_predictive</span><span class="p">],</span>
    <span class="n">shade</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span>
    <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\mu_</span><span class="si">{thickness}</span><span class="s1">$&#39;</span><span class="p">],</span>
    <span class="n">data_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Posterior Predictive&quot;</span><span class="p">,</span> <span class="s2">&quot;Prior Predictive&quot;</span><span class="p">],</span>
    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">default_red</span><span class="p">,</span> <span class="n">default_blue</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_1-thickness_problem_003.png" srcset="../_images/sphx_glr_1-thickness_problem_003.png" alt="$\mu_{thickness}$" class = "sphx-glr-single-img"/></section>
<section id="marginal-distribution-plots">
<h2>Marginal Distribution Plots<a class="headerlink" href="#marginal-distribution-plots" title="Permalink to this heading">¬∂</a></h2>
<p>Marginal distribution plots provide insights into the distribution of individual parameters.
These plots help in understanding the uncertainty and variability in the parameter estimates.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating marginal distribution plots</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">PlotPosterior</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">joyplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">marginal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">likelihood</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot_marginal</span><span class="p">(</span>
    <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_</span><span class="si">{top}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_</span><span class="si">{bottom}</span><span class="s1">$&#39;</span><span class="p">],</span>
    <span class="n">plot_trace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">credible_interval</span><span class="o">=</span><span class="mf">.70</span><span class="p">,</span>
    <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">,</span>
    <span class="n">marginal_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bw&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_1-thickness_problem_004.png" srcset="../_images/sphx_glr_1-thickness_problem_004.png" alt="1 thickness problem" class = "sphx-glr-single-img"/></section>
<section id="posterior-distribution-visualization">
<h2>Posterior Distribution Visualization<a class="headerlink" href="#posterior-distribution-visualization" title="Permalink to this heading">¬∂</a></h2>
<p>This section provides a more detailed visualization of the posterior distributions
of the parameters, integrating different aspects of the probabilistic model.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualizing the posterior distributions</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">PlotPosterior</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">joyplot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">iteration</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot_posterior</span><span class="p">(</span>
    <span class="n">prior_var</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_</span><span class="si">{top}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_</span><span class="si">{bottom}</span><span class="s1">$&#39;</span><span class="p">],</span>
    <span class="n">like_var</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_</span><span class="si">{top}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_</span><span class="si">{bottom}</span><span class="s1">$&#39;</span><span class="p">],</span>
    <span class="n">obs</span><span class="o">=</span><span class="s1">&#39;y_</span><span class="si">{thickness}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">iteration</span><span class="o">=</span><span class="n">iteration</span><span class="p">,</span>
    <span class="n">marginal_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;credible_interval&quot;</span><span class="p">:</span> <span class="mf">0.94</span><span class="p">,</span>
        <span class="s1">&#39;marginal_kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;bw&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="s1">&#39;joint_kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;bw&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_1-thickness_problem_005.png" srcset="../_images/sphx_glr_1-thickness_problem_005.png" alt="Likelihood" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/leguark/gempy_probability/gempy_probability/plot_posterior.py:239: UserWarning: color is redundantly defined by the &#39;color&#39; keyword argument and the fmt string &quot;bo&quot; (-&gt; color=&#39;b&#39;). The keyword argument will take precedence.
  self.axjoin.plot(theta1_val, theta2_val, &#39;bo&#39;, ms=6, color=&#39;k&#39;)
</pre></div>
</div>
</section>
<section id="pair-plot-of-key-parameters">
<h2>Pair Plot of Key Parameters<a class="headerlink" href="#pair-plot-of-key-parameters" title="Permalink to this heading">¬∂</a></h2>
<p>Pair plots are useful to visualize the relationships and correlations between different parameters.
They help in understanding how parameters influence each other in the probabilistic model.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating a pair plot for selected parameters</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_pair</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">divergences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_</span><span class="si">{top}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_</span><span class="si">{bottom}</span><span class="s1">$&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_1-thickness_problem_006.png" srcset="../_images/sphx_glr_1-thickness_problem_006.png" alt="1 thickness problem" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  5.299 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-basic-geology-1-thickness-problem-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/4d445e2420b0cf08f7cb91ba11a8543a/1-thickness_problem.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">1-thickness_problem.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/5b008c0b26314d4a869ca098a195a870/1-thickness_problem.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">1-thickness_problem.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logos/gempy.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=gempy-project&repo=gempy&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Probabilistic modeling for Structural Geology</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../examples_intro/index.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples_first_example_of_inference/index.html">Ôªø1 - First example of inference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Ôªø2 - Probabilistic Geomodel</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#probability-density-transformation">Probability density transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples_probabilistic_inversion/index.html">Ôªø3 - Probabilistic Geophysics (WIP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples_utils/index.html">ÔªøUtilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html#data-classes">Data Classes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Ôªø2 - Probabilistic Geomodel</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Ôªø2 - Probabilistic Geomodel</a></li>
      <li>Next: <a href="2-thickness_problem_gempy.html" title="next chapter">2.2 - Including GemPy</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023-2023, Gempy Probability Developers.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/examples_basic_geology/1-thickness_problem.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>