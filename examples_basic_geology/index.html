<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>﻿2 - Probabilistic Geomodel &#8212; GemPy 2024.2.0.3.dev0+gf344a731.d20240626 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=270d38c7" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script src="../_static/documentation_options.js?v=bd57e1ea"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.1 - Only Pyro" href="1-thickness_problem.html" />
    <link rel="prev" title="Uniform Prior, several observations" href="../examples_first_example_of_inference/1-bayesian_basics/1.4_Intro_to_Bayesian_Inference.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="probabilistic-geomodel">
<h1>﻿2 - Probabilistic Geomodel<a class="headerlink" href="#probabilistic-geomodel" title="Link to this heading">¶</a></h1>
<section id="probability-density-transformation">
<h2>Probability density transformation<a class="headerlink" href="#probability-density-transformation" title="Link to this heading">¶</a></h2>
<p>In the example above the parameters that define the likelihood function <span class="math notranslate nohighlight">\(\pi_S(\theta)\)</span> were directly the prior parameters that we define–the top most level of the probability graph. The simplicity of that model allows for an easy interpretation of the whole inference as the joint probability of the prior distributions, <span class="math notranslate nohighlight">\(\mu_\theta\)</span> and <span class="math notranslate nohighlight">\(\sigma_\theta\)</span>, and likelihood functions <span class="math notranslate nohighlight">\(\pi(y|\theta)\)</span>  (for one observation). However, there is not reason why the prior random variable—e.g. <span class="math notranslate nohighlight">\(\mu_\theta\)</span> or <span class="math notranslate nohighlight">\(\sigma_\theta\)</span> above—has to derive from one of the “classical” probability density functions—e.g. Normal or Gamma. This means that we can perform as many transformations of a random variables, <span class="math notranslate nohighlight">\(\theta\)</span>, as we please before we plug them into a likelihood function, <span class="math notranslate nohighlight">\(\pi(y|\theta)\)</span>. This is important because usually we will be able to describe <span class="math notranslate nohighlight">\(\theta\)</span> as function of other random variables either because they are easier to estimate or because it will allow to grow the probabilistic model to integrate multiple data set and knowledge in a coherent fashion.</p>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip=" Model definition ----------------"><img alt="" src="../_images/sphx_glr_1-thickness_problem_thumb.png" />
<p><a class="reference internal" href="1-thickness_problem.html#sphx-glr-examples-basic-geology-1-thickness-problem-py"><span class="std std-ref">2.1 - Only Pyro</span></a></p>
  <div class="sphx-glr-thumbnail-title">2.1 - Only Pyro</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Complex probabilistic model ---------------------------"><img alt="" src="../_images/sphx_glr_2-thickness_problem_gempy_thumb.png" />
<p><a class="reference internal" href="2-thickness_problem_gempy.html#sphx-glr-examples-basic-geology-2-thickness-problem-gempy-py"><span class="std std-ref">2.2 - Including GemPy</span></a></p>
  <div class="sphx-glr-thumbnail-title">2.2 - Including GemPy</div>
</div></div><div class="toctree-wrapper compound">
</div>
<section id="probabilistic-modelling-with-gempy">
<h3>﻿Probabilistic modelling with GemPy<a class="headerlink" href="#probabilistic-modelling-with-gempy" title="Link to this heading">¶</a></h3>
<p>In structural geology, we want to combine different types of data—i.e. geometrical measurements, geophysics, petrochemical data—usually using as a prevailing model a <em>common earth model</em>. For the sake of simplicity, in this example, we will combine different type of geometric information into one single probabilistic model. Let’s build on the previous idea in order to extend the conceptual case above back to geological modelling.</p>
<p>Lucky for us, after we perform the first inference on the thickness, <span class="math notranslate nohighlight">\(\tilde{y}_{thickness}\)</span> of the model, we find out that a colleague has been gathering data at the exact same outcrop but in his case he was recording the location of the top <span class="math notranslate nohighlight">\(\tilde{y}_{top}\)</span> and bottom <span class="math notranslate nohighlight">\(\tilde{y}_{bottom}\)</span> interfaces of the layer. We can relate the three data sets with simple algebra:</p>
<div class="math notranslate nohighlight">
\[\pi(\theta_{thickness}) = \pi(\theta_{top})  - \pi(\theta_{bottom})\]</div>
<p>or,</p>
<div class="math notranslate nohighlight">
\[\pi(\theta_{bottom})  = \pi(\theta_{top})  - \pi(\theta_{thickness})\]</div>
<p>now the question is which probabilistic model design is more suitable. In the end this relates directly to the question the model is trying to answer—and possible limitations on the algorithms used—since joint probability follows the commutative and associative properties.</p>
<div class="sphx-glr-thumbnails"></div></section>
<section id="example-of-inference">
<h3>﻿Example of Inference<a class="headerlink" href="#example-of-inference" title="Link to this heading">¶</a></h3>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/Thickness_example.svg"><img alt="../_images/Thickness_example.svg" src="../_images/Thickness_example.svg" width="80%" /></a>
<figcaption>
<p><span class="caption-text">Prior (in blue) and posterior distributions (in red) of all the parameters of the probabilistic model <span class="math notranslate nohighlight">\(\theta\)</span> (the full list of values of the simulation can be found in Appendix X). Case A) correspond to the subtraction equation while Case B) has been generated with the summation equation. Both cases yield the exact same posterior for the random variables—within the Monte Carlo error—as expected.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="correlations">
<h3>Correlations<a class="headerlink" href="#correlations" title="Link to this heading">¶</a></h3>
<p>Furthermore, keep in mind that the inference happens in a multidimensional manifold—although for obvious visualization reasons we display each parameter independently. This means that although in the previous figures the posterior distributions seem independent, a closer examination—e.g. joint plots—uncovers correlation in the parameters.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../_images/correlation.png"><img alt="../_images/correlation.png" src="../_images/correlation.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-text">Correlations between parameters can be uncovered with joint plots.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading">¶</a></h2>
<p>The code in this case study is copyrighted by Miguel de la Varga and licensed under the new BSD (3-clause) license:</p>
<p><a class="reference external" href="https://opensource.org/licenses/BSD-3-Clause">https://opensource.org/licenses/BSD-3-Clause</a></p>
<p>The text and figures in this case study are copyrighted by Miguel de la Varga and licensed under the CC BY-NC 4.0 license:</p>
<p><a class="reference external" href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</a>
Make sure to replace the links with actual hyperlinks if you’re using a platform that supports it (e.g., Markdown or HTML). Otherwise, the plain URLs work fine for plain text.</p>
<div class="sphx-glr-thumbnails"></div><p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logos/gempy.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=gempy-project&repo=gempy&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Probabilistic modeling for Structural Geology</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../examples_intro/index.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples_first_example_of_inference/index.html">﻿1 - First example of inference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">﻿2 - Probabilistic Geomodel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#probability-density-transformation">Probability density transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples_probabilistic_inversion/index.html">﻿3 - Probabilistic Geophysics (WIP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples_utils/index.html">﻿Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html#data-classes">Data Classes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../examples_first_example_of_inference/1-bayesian_basics/1.4_Intro_to_Bayesian_Inference.html" title="previous chapter">Uniform Prior, several observations</a></li>
      <li>Next: <a href="1-thickness_problem.html" title="next chapter">2.1 - Only Pyro</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023-2024, Gempy Probability Developers.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/examples_basic_geology/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>